<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Custom Jetty Modules :: Eclipse Jetty</title>
    <link rel="canonical" href="https://jetty.org/docs/jetty/12/operations-guide/modules/custom.html">
    <link rel="prev" href="index.html">
    <link rel="next" href="standard.html">
    <meta name="generator" content="Antora 3.1.7">
    <link rel="stylesheet" href="../../../../../_/css/site.css">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VS4ZRD6HVM"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','G-VS4ZRD6HVM')</script>
    <link rel="icon" href="../../../../../_/img/favicon.ico" type="image/x-icon"/>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item logo" href="https://jetty.org"><img src="../../../../../_/img/jetty-logo.svg" alt="Eclipse Jetty" width="120"></a>
      <a class="navbar-item" href="https://jetty.org">Eclipse Jetty</a>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item search hide-for-print">
          <div id="search-field" class="field">
            <input id="search-input" type="text" placeholder="Search the docs">
          </div>
        </div>
        <a class="navbar-item" href="../../../../index.html">Documentation</a>
        <a class="navbar-item" href="../../../../../support.html">Support</a>
        <!--a class="navbar-item" href="../../../../../community.html">Community</a-->
        <a class="navbar-item" href="../../../../../security.html">Security</a>
        <a class="navbar-item" href="../../../../../download.html">Download</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Links</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://github.com/jetty/jetty.project">Source Code</a>
            <a class="navbar-item" href="https://github.com/jetty/jetty.project/issues">Issues</a>
            <a class="navbar-item" href="../../../../contribution-guide/index.html">Contributing</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="jetty" data-version="12">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../../index.html">Eclipse Jetty</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../index.html">Operations Guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../begin/index.html">Getting Started</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../features/index.html">Eclipse Jetty Features</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../howtos/index.html">Eclipse Jetty How-Tos</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../arch/index.html">Architecture Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../start/index.html">Jetty Start Mechanism</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../start/start-jpms.html">Starting Jetty using JPMS</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">Jetty Modules</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="custom.html">Custom Jetty Modules</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="standard.html">Standard Modules</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../deploy/index.html">Web Application Deployment</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../server/index.html">Jetty Server</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../protocols/index.html">Jetty Connectors and Protocols</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../keystore/index.html">Configuring SSL/TLS KeyStores</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../session/index.html">HTTP Session Management</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../quickstart/index.html">Faster Web Application Deployment</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../annotations/index.html">Annotations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../jsp/index.html">Java Server Pages</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../jstl/index.html">JavaServer Pages Standard Tag Libraries</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../jsf-taglibs/index.html">JavaServer Faces TagLibs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../jndi/index.html">JNDI</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../jaas/index.html">JAAS</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../jaspi/index.html">JASPI</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../jmx/index.html">JMX Monitoring &amp; Management</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tools/index.html">Jetty Tools</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../troubleshooting/index.html">Troubleshooting</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../xml/index.html">Jetty XML</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../programming-guide/index.html">Programming Guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../programming-guide/client/index.html">Client Libraries</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/client/io-arch.html">I/O Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/client/http.html">HTTP Client</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/client/http2.html">HTTP/2 Client Library</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/client/http3.html">HTTP/3 Client Library</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/client/websocket.html">WebSocket Client</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../programming-guide/server/index.html">Server Libraries</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/server/http.html">HTTP Server Libraries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/server/http2.html">HTTP/2 Server Library</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/server/http3.html">HTTP/3 Server Library</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/server/compliance.html">Server Compliance Modes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/server/session.html">HTTP Session Management</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/server/websocket.html">WebSocket Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/server/fastcgi.html">FastCGI Server Libraries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/server/io-arch.html">Server I/O Architecture</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Maven and Jetty</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/maven-jetty/jetty-maven-helloworld.html">Using Maven</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/maven-jetty/jetty-maven-plugin.html">Using the Jetty Maven Plugin</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/maven-jetty/jetty-jspc-maven-plugin.html">Jetty Jspc Maven Plugin</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jetty Architecture</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/arch/bean.html">Jetty Component Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/arch/threads.html">Jetty Threading Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/arch/io.html">Jetty I/O Architecture</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/arch/listener.html">Jetty Listeners</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/arch/jmx.html">Jetty JMX Support</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../programming-guide/troubleshooting/index.html">Troubleshooting Jetty</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/troubleshooting/logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/troubleshooting/thread-dump.html">JVM Thread Dump</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/troubleshooting/state-tracking.html"><code>StateTrackingHandler</code></a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/troubleshooting/component-dump.html">Component Tree Dump</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/troubleshooting/debugging.html">Remote Debugging</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Migration Guides</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/migration/94-to-10.html">Migrating from Jetty 9.4.x to Jetty 10.0.x</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../programming-guide/migration/11-to-12.html">Migrating from Jetty 11.0.x to Jetty 12.0.x</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Eclipse Jetty</span>
    <span class="version">12</span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../../../../contribution-guide/index.html">Contribution Guide</a></div>
    </li>
    <li class="component is-current">
      <div class="title"><a href="../../index.html">Eclipse Jetty</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">12</a>
        </li>
        <li class="version">
          <a href="../../../11/index.html">11</a>
        </li>
        <li class="version">
          <a href="../../../10/index.html">10</a>
        </li>
      </ul>
    </li>
    </li>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Eclipse Jetty</a></li>
    <li><a href="../index.html">Operations Guide</a></li>
    <li><a href="index.html">Jetty Modules</a></li>
    <li><a href="custom.html">Custom Jetty Modules</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">12</button>
  <div class="version-menu">
    <a class="version is-current" href="custom.html">12</a>
    <a class="version" href="../../../11/operations-guide/modules/custom.html">11</a>
    <a class="version" href="../../../10/operations-guide/modules/custom.html">10</a>
  </div>
</div>
<div class="edit-this-page"><a href="https://github.com/jetty/jetty.project/edit/jetty-12.0.x/documentation/jetty/modules/operations-guide/pages/modules/custom.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Page Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Custom Jetty Modules</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In addition to the modules that come packaged with Jetty, you can create your own custom modules.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Make sure you have read the <a href="index.html" class="xref page">Jetty modules section</a> if you are not familiar with the concepts used in this section.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Custom modules can be used for a number of reasons&#8201;&#8212;&#8201;they can extend Jetty features, or add new features, or make additional libraries available to the server, etc.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="modify"><a class="anchor" href="#modify"></a>Modifying an Existing Module</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The standard Jetty modules typically come with a number of configurable properties that can be easily customized without the need of writing a custom module.</p>
</div>
<div class="paragraph">
<p>However, there may be cases where the customization is more complex than a simple property, and a custom module is necessary.</p>
</div>
<div class="paragraph">
<p>For example, let&#8217;s assume that you want to modify the order of the TLS cipher suites offered by the server when a client connects, using the <a href="https://www.openssl.org/docs/man1.1.0/man1/ciphers.html">OpenSSL cipher list format</a>.</p>
</div>
<div class="paragraph">
<p>The Jetty class that handles the TLS configuration is <code>SslContextFactory</code>, and it already has a method <code>setCipherComparator(Comparator&lt;String&gt;)</code>; however, you need to pass your custom implementation, which cannot be represented with a simple module property.</p>
</div>
<div class="paragraph">
<p>The <code>SslContextFactory</code> component is already allocated by the standard Jetty module <code>ssl</code>, so what you need to do is the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Write the custom cipher <code>Comparator</code> and package it into a <code>*.jar</code> file (exercise left to reader).</p>
</li>
<li>
<p>Write a custom Jetty XML file that calls the <code>SslContextFactory.setCipherComparator(Comparator&lt;String&gt;)</code> method.</p>
</li>
<li>
<p>Write a custom Jetty module file that depends on the standard <code>ssl</code> module.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Start with the custom Jetty XML file, <code>$JETTY_BASE/etc/custom-ssl.xml</code>:</p>
</div>
<div class="listingblock">
<div class="title">custom-ssl.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE Configure PUBLIC "-//Jetty//Configure//EN" "https://eclipse.dev/jetty/configure_10_0.dtd"&gt;
&lt;Configure&gt;
  &lt;Ref refid="sslContextFactory"&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;Set name="CipherComparator"&gt; <i class="conum" data-value="2"></i><b>(2)</b>
      &lt;New class="com.acme.ssl.CustomCipherComparator"&gt; <i class="conum" data-value="3"></i><b>(3)</b>
        &lt;Arg&gt;
          &lt;Property name="com.acme.ssl.cipherList"&gt; <i class="conum" data-value="4"></i><b>(4)</b>
            &lt;Default&gt;ECDH+AESGCM:ECDH+AES256:!aNULL:!MD5:!DSS:!ADH&lt;/Default&gt;
          &lt;/Property&gt;
        &lt;/Arg&gt;
      &lt;/New&gt;
    &lt;/Set&gt;
  &lt;/Ref&gt;
&lt;/Configure&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Reference the existing <code>SslContextFactory</code> object created by the standard <code>ssl</code> module using its <code>id</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Call the <code>setCipherComparator()</code> method.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Instantiate your custom cipher comparator.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Pass to the constructor the ordering string in OpenSSL format, reading it from the module property <code>com.acme.ssl.cipherList</code>.</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
The cipher list used above may not be secure&#8201;&#8212;&#8201;it&#8217;s just an example.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then write your custom module in the <code>$JETTY_BASE/modules/custom-ssl.mod</code> file:</p>
</div>
<div class="listingblock">
<div class="title">custom-ssl.mod</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">[description]
Customizes the standard ssl module.

[tags] <i class="conum" data-value="1"></i><b>(1)</b>
acme

[depends] <i class="conum" data-value="2"></i><b>(2)</b>
ssl

[lib] <i class="conum" data-value="3"></i><b>(3)</b>
lib/custom-cipher-comparator.jar

[xml] <i class="conum" data-value="4"></i><b>(4)</b>
etc/custom-ssl.xml

[ini-template] <i class="conum" data-value="5"></i><b>(5)</b>
## The cipher list in OpenSSL format.
# com.acme.ssl.cipherList=ECDH+AESGCM:ECDH+AES256:!aNULL:!MD5:!DSS:!ADH</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A tag that characterizes this custom module (see <a href="index.html#directive-tags" class="xref page">here</a>).</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This custom module depends on the standard <code>ssl</code> module.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The custom cipher comparator class is compiled and packaged into this <code>*.jar</code> file.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The custom Jetty XML file from above.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The text that will be copied in the <code>custom-ssl.ini</code> file when this custom module will be enabled.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now you can <a href="../start/index.html#configure-enable" class="xref page">enable</a> the custom module with the following command issued from the <code>$JETTY_BASE</code> directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ java -jar $JETTY_HOME/start.jar --add-modules=https,custom-ssl</pre>
</div>
</div>
<div class="paragraph">
<p>The command above will produce the following <code>$JETTY_BASE</code> directory structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$JETTY_BASE
├── etc
│   └── custom-ssl.xml
├── modules
│   └── custom-ssl.mod
├── resources
│   └── jetty-logging.properties
└── start.d
    ├── https.ini
    └── <mark>custom-ssl.ini</mark></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the custom XML file you have used a custom module property to parametrize your custom cipher comparator.
This custom module property was then referenced in the <code>[ini-template]</code> section of the custom module file, so that when the custom module is enabled, a correspondent <code>custom-ssl.ini</code> file is created.</p>
</div>
<div class="paragraph">
<p>In this way, updating the cipher list won&#8217;t require you to update the XML file, but just the <code>custom-ssl.ini</code> file.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create"><a class="anchor" href="#create"></a>Creating a New Module</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the cases where you need to enhance Jetty with a custom functionality, you can write a new Jetty module that provides it.</p>
</div>
<div class="paragraph">
<p>For example, let&#8217;s assume that you need to add a custom auditing component that integrates with the auditing tools used by your company.
This custom auditing component should measure the HTTP request processing times and record them (how they are recorded is irrelevant here&#8201;&#8212;&#8201;could be in a local log file or sent via network to an external service).</p>
</div>
<div class="paragraph">
<p>The Jetty libraries already provide a way to measure HTTP request processing times via <a href="../../programming-guide/server/http.html#handler-use-events" class="xref page"><code>EventsHandler</code></a>: you write a custom <code>EventsHandler</code> subclass that overrides the methods corresponding to the events you are interested in.</p>
</div>
<div class="paragraph">
<p>The steps to create a Jetty module are similar to those necessary to <a href="#modify">modify an existing module</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Write the auditing component and package it into a <code>*.jar</code> file.</p>
</li>
<li>
<p>Write a custom Jetty XML file that wires the auditing component to the <code>Handler</code> tree.</p>
</li>
<li>
<p>Write a custom Jetty module file that puts everything together.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s start with the auditing component, sketched below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.acme.audit;

public class AuditingEventsHandler extends EventsHandler {
    // Auditing is implemented here.
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s assume that this class is compiled and packaged into <code>acme-audit.jar</code>, and that it has a dependency on <code>acme-util.jar</code>.
Both <code>*.jar</code> files will be put in the <code>$JETTY_BASE/lib/</code> directory.</p>
</div>
<div class="paragraph">
<p>Next, let&#8217;s write the Jetty XML file that wires the auditing component to the <code>ServerConnector</code>, <code>$JETTY_BASE/etc/acme-audit.xml</code>:</p>
</div>
<div class="listingblock">
<div class="title">acme-audit.xml</div>
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE Configure PUBLIC "-//Jetty//Configure//EN" "https://eclipse.dev/jetty/configure_10_0.dtd"&gt;
&lt;Configure&gt;
  &lt;Ref refid="Server"&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;Call name="insertHandler"&gt; <i class="conum" data-value="2"></i><b>(2)</b>
      &lt;Arg&gt;
        &lt;New class="com.acme.audit.AuditingEventsHandler"&gt; <i class="conum" data-value="3"></i><b>(3)</b>
          &lt;Set name="someProperty"&gt;
            &lt;Property name="com.acme.audit.some.property" default="42" /&gt; <i class="conum" data-value="4"></i><b>(4)</b>
          &lt;/Set&gt;
        &lt;/New&gt;
      &lt;/Arg&gt;
    &lt;/Call&gt;
  &lt;/Ref&gt;
&lt;/Configure&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Reference <code>Server</code> instance.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Call <code>insertHandler()</code> on the <code>Server</code> so that the auditing component will be inserted just after the <code>Server</code> and just before its child <code>Handler</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Instantiate the auditing component.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Configure the auditing component with a property.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The last step is to create the custom Jetty module file for the auditing component, <code>$JETTY_BASE/modules/acme-audit.mod</code>:</p>
</div>
<div class="listingblock">
<div class="title">acme-audit.mod</div>
<div class="content">
<pre>[description]
Adds ACME auditing to the Jetty Server.

[tags] <i class="conum" data-value="1"></i><b>(1)</b>
acme
audit

[depends] <i class="conum" data-value="2"></i><b>(2)</b>
server

[libs] <i class="conum" data-value="3"></i><b>(3)</b>
lib/acme-audit.jar
lib/acme-util.jar

[xml] <i class="conum" data-value="4"></i><b>(4)</b>
etc/acme-audit.xml

[ini-template] <i class="conum" data-value="5"></i><b>(5)</b>
## An auditing property.
# com.acme.audit.some.property=42</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The tags that characterize this custom module (see <a href="index.html#directive-tags" class="xref page">here</a>).</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This custom module depends on the standard <code>server</code> module.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>*.jar</code> files that contains the custom auditing component, and its dependencies.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The custom Jetty XML file from above.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>The text that will be copied in the <code>acme-audit.ini</code> file when this custom module will be enabled.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now you can <a href="../start/index.html#configure-enable" class="xref page">enable</a> the custom auditing module with the following command issued from the <code>$JETTY_BASE</code> directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$ java -jar $JETTY_HOME/start.jar --add-modules=http,acme-audit</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command above will produce the following <code>$JETTY_BASE</code> directory structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">$JETTY_BASE
├── etc
│   └── acme-audit.xml
├── modules
│   └── acme-audit.mod
├── resources
│   └── jetty-logging.properties
└── start.d
    ├── http.ini
    └── <mark>acme-audit.ini</mark></code></pre>
</div>
</div>
<div class="paragraph">
<p>Enabling the custom auditing component will create the <code>$JETTY_BASE/start.d/acme-audit.ini</code> module configuration file that you can edit to configure auditing properties.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="index.html">Jetty Modules</a></span>
  <span class="next"><a href="standard.html">Standard Modules</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="footer-main">
    <figure class="footer-brand">
      <a class="logo" href="https://jetty.org"><img src="../../../../../_/img/jetty-logo.svg" alt="Eclipse Jetty" height="46" width="160"></a>
    </figure>
    <ul class="footer-brand-links">
      <li><a href="../../../../index.html">Docs</a></li>
      <li><a href="../../../../../support.html">Support</a></li>
      <li>Lists: <a href="http://dev.eclipse.org/mhonarc/lists/jetty-users/maillist.html" target="_blank" rel="noopener">users</a> - <a href="http://dev.eclipse.org/mhonarc/lists/jetty-dev/maillist.html" target="_blank" rel="noopener">dev</a></li>
      <li><a href="https://github.com/eclipse/jetty.project" target="_blank" rel="noopener">Source</a></li>
    </ul>
    <p class="footer-brand-follow">
      <a href="https://twitter.com/JettyProject" title="Follow us on X" target="_blank" rel="noopener"><img src="../../../../../_/img/x-logo.svg" alt="X logo" class="logo" width="24"><span class="handle">@JettyProject</span></a>
    </p>
  </div>
  <div class="footer-legal">
    <p>Copyright © 2008-2024 Webtide</p>
    <p>The <a href="https://github.com/jetty/jetty.website" target="_blank" rel="noopener">UI for this site</a> is derived from the Antora default UI and is licensed under the MPL-2.0 license. Several icons are imported from <a href="https://primer.style/octicons/" target="_blank" rel="noopener">Octicons</a> and are licensed under the MIT license.</p>
    <p>Eclipse Jetty® is a trademarks of the Eclipse Foundation, Inc.</p>
  </div>
  <div class="footer-thanks">
    <p>This project is made possible by Webtide. Additional thanks to the <a href="https://eclipse.org" target="_blank" rel="noopener">Eclipse Foundation</a> for hosting this project.</p>
    <p class="badges">
      <a href="https://webtide.com" title="Development led by Webtide" target="_blank" rel="noopener"><img src="../../../../../_/img/webtide-logo.png" alt="Webtide Logo" width="100"></a>
      <a href="https://jetbrains.com/idea" title="IntelliJ IDEA integration provided by JetBrains" target="_blank" rel="noopener"><img src="../../../../../_/img/jetbrains.svg" alt="Jetbrains Logo" width="24"></a>
    </p>
    <p>Authored in <a href="https://asciidoc.org" target="_blank" rel="noopener">AsciiDoc</a>.<br>Produced by <a href="https://antora.org" target="_blank" rel="noopener">Antora</a> and <a href="https://asciidoctor.org" target="_blank" rel="noopener">Asciidoctor</a>.</p>
  </div>
</footer>
<script id="site-script" src="../../../../../_/js/site.js" data-ui-root-path="../../../../../_"></script>
<script async src="../../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../../.." data-snippet-length="100" data-stylesheet="../../../../../_/css/search.css"></script>
<script async src="../../../../../search-index.js"></script>
  </body>
</html>